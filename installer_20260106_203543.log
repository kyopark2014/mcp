2026-01-06 20:35:43 - INFO - ============================================================
2026-01-06 20:35:43 - INFO - Starting AWS Infrastructure Deployment
2026-01-06 20:35:43 - INFO - ============================================================
2026-01-06 20:35:43 - INFO - Project: mcp
2026-01-06 20:35:43 - INFO - Region: us-west-2
2026-01-06 20:35:43 - INFO - Account ID: 262976740991
2026-01-06 20:35:43 - INFO - Bucket Name: storage-for-mcp-262976740991-us-west-2
2026-01-06 20:35:43 - INFO - ============================================================
2026-01-06 20:35:43 - INFO - [1/9] Creating S3 bucket: storage-for-mcp-262976740991-us-west-2
2026-01-06 20:35:46 - INFO - ✓ S3 bucket created successfully: storage-for-mcp-262976740991-us-west-2
2026-01-06 20:35:46 - INFO - [2/9] Creating Knowledge Base IAM role
2026-01-06 20:35:47 - INFO - ✓ IAM role created: role-knowledge-base-for-mcp-us-west-2
2026-01-06 20:35:48 - INFO - [2/9] Creating Agent IAM role
2026-01-06 20:35:48 - INFO - ✓ IAM role created: role-agent-for-mcp-us-west-2
2026-01-06 20:35:49 - INFO - [2/9] Creating EC2 IAM role
2026-01-06 20:35:50 - INFO - ✓ IAM role created: role-ec2-for-mcp-us-west-2
2026-01-06 20:35:55 - INFO - [2/9] Creating Lambda RAG IAM role
2026-01-06 20:35:55 - INFO - ✓ IAM role created: role-lambda-rag-for-mcp-us-west-2
2026-01-06 20:35:57 - INFO - [2/9] Creating AgentCore Memory IAM role
2026-01-06 20:35:57 - INFO - ✓ IAM role created: role-agentcore-memory-for-mcp-us-west-2
2026-01-06 20:35:57 - INFO - [3/9] Creating Secrets Manager secrets
2026-01-06 20:35:57 - INFO - Please enter API keys when prompted (press Enter to skip and leave empty):
2026-01-06 20:35:58 - INFO - Enter credential of openweathermap-mcp (Weather API Key - OpenWeatherMap):
2026-01-06 20:36:30 - INFO -   ✓ Created secret: openweathermap-mcp
2026-01-06 20:36:30 - INFO - Enter credential of langsmithapikey-mcp (LangSmith API Key):
2026-01-06 20:36:38 - INFO -   ✓ Created secret: langsmithapikey-mcp
2026-01-06 20:36:38 - INFO - Enter credential of tavilyapikey-mcp (Tavily API Key):
2026-01-06 20:36:46 - INFO -   ✓ Created secret: tavilyapikey-mcp
2026-01-06 20:36:46 - INFO - Enter credential of perplexityapikey-mcp (Perplexity API Key):
2026-01-06 20:36:55 - INFO -   ✓ Created secret: perplexityapikey-mcp
2026-01-06 20:36:56 - INFO - Enter credential of firecrawlapikey-mcp (Firecrawl API Key):
2026-01-06 20:37:07 - INFO -   ✓ Created secret: firecrawlapikey-mcp
2026-01-06 20:37:07 - INFO - Enter credential of novaactapikey-mcp (Nova Act API Key):
2026-01-06 20:37:17 - INFO -   ✓ Created secret: novaactapikey-mcp
2026-01-06 20:37:17 - INFO - Enter credential of notionapikey-mcp (Notion API Key):
2026-01-06 20:37:25 - INFO -   ✓ Created secret: notionapikey-mcp
2026-01-06 20:37:25 - INFO - ✓ Created 7 secrets
2026-01-06 20:37:25 - INFO - [4/9] Creating OpenSearch Serverless collection
2026-01-06 20:37:32 - INFO -   Waiting for collection to be active (this may take a few minutes)...
2026-01-06 20:39:03 - INFO - ✓ OpenSearch collection created: mcp
2026-01-06 20:39:03 - INFO -   Endpoint: https://ovh7cwt8xvkrelj2gq8g.us-west-2.aoss.amazonaws.com
2026-01-06 20:39:03 - INFO - OpenSearch collection created: {'arn': 'arn:aws:aoss:us-west-2:262976740991:collection/ovh7cwt8xvkrelj2gq8g', 'endpoint': 'https://ovh7cwt8xvkrelj2gq8g.us-west-2.aoss.amazonaws.com'}
2026-01-06 20:39:03 - INFO - [4.5/9] Creating Knowledge Base with OpenSearch collection
2026-01-06 20:39:03 - INFO -   Creating vector index in OpenSearch collection...
2026-01-06 20:39:03 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2026-01-06 20:39:05 - INFO -   ✓ Vector index 'mcp' created successfully
2026-01-06 20:39:05 - INFO -   Waiting for index to be ready...
2026-01-06 20:39:35 - INFO -   Checking if Knowledge Base already exists...
2026-01-06 20:39:35 - INFO -   Knowledge Base does not exist. Creating new one...
2026-01-06 20:39:38 - INFO - ✓ Knowledge Base created: W0O8PROBAV
2026-01-06 20:39:38 - INFO -   Waiting for Knowledge Base to be active...
2026-01-06 20:39:48 - INFO -   Knowledge Base is now active
2026-01-06 20:39:48 - INFO -   Creating data source...
2026-01-06 20:39:49 - INFO -   ✓ Data source created: B7JHDKIKVN
2026-01-06 20:39:49 - INFO - [5/9] Creating VPC and networking resources
2026-01-06 20:39:49 - INFO - Using CIDR block: 10.22.0.0/16
2026-01-06 20:39:50 - WARNING - VPC already exists: vpc-079e81539916b1b44
2026-01-06 20:39:50 - INFO -   No private subnets found. Creating private subnets for EC2 deployment...
2026-01-06 20:39:50 - WARNING - Error processing existing VPC vpc-079e81539916b1b44: Cannot create private subnets without public subnets for NAT Gateway. Please ensure your VPC has at least one public subnet.
2026-01-06 20:39:50 - WARNING - Returning existing VPC with minimal configuration. Some resources may need manual setup.
2026-01-06 20:39:50 - INFO - [6/9] Creating Application Load Balancer
2026-01-06 20:39:51 - WARNING -   No public subnets found in vpc_info. Attempting to find public subnets from VPC...
2026-01-06 20:39:51 - WARNING -   No subnets found in VPC vpc-079e81539916b1b44
2026-01-06 20:39:51 - INFO -   Found only 0 public subnet(s). Creating additional public subnets for ALB...
2026-01-06 20:39:52 - INFO -   No Internet Gateway found. Creating Internet Gateway...
2026-01-06 20:39:53 - INFO -   Created and attached Internet Gateway: igw-0d1b4c75d561d52f9
2026-01-06 20:39:54 - INFO -   Created public route table: rtb-068a17c01cf09ff6d
2026-01-06 20:39:54 - INFO -   Created public subnet: subnet-0fa7839d0117beb22 in us-west-2a with CIDR 10.21.0.0/24
2026-01-06 20:39:55 - INFO -   Created public subnet: subnet-02368514d62f5bce8 in us-west-2b with CIDR 10.21.1.0/24
2026-01-06 20:39:56 - INFO -   ALB security group not found. Creating ALB security group...
2026-01-06 20:39:57 - INFO -   Found existing ALB security group: sg-00db7827a2ec7fdf6
2026-01-06 20:39:59 - INFO - ✓ ALB created: alb-for-mcp-121902792.us-west-2.elb.amazonaws.com
2026-01-06 20:39:59 - INFO - [7/9] Creating CloudFront distribution
2026-01-06 20:40:00 - WARNING - Could not get reference distribution config: An error occurred (NoSuchDistribution) when calling the GetDistributionConfig operation: The specified distribution does not exist.
2026-01-06 20:40:01 - INFO - ✓ CloudFront distribution created: d3k2ftb31oetxi.cloudfront.net
2026-01-06 20:40:01 - INFO -   Distribution ID: E1XSC9YQO4U6EC
2026-01-06 20:40:01 - WARNING -   Note: CloudFront distribution may take 15-20 minutes to deploy
2026-01-06 20:40:01 - INFO - [8/9] Creating EC2 instance
2026-01-06 20:40:04 - ERROR - 
2026-01-06 20:40:04 - ERROR - ============================================================
2026-01-06 20:40:04 - ERROR - Deployment Failed!
2026-01-06 20:40:04 - ERROR - ============================================================
2026-01-06 20:40:04 - ERROR - Error: list index out of range
2026-01-06 20:40:04 - ERROR - Deployment time before failure: 4.35 minutes
2026-01-06 20:40:04 - ERROR - ============================================================
2026-01-06 20:40:04 - ERROR - Traceback (most recent call last):
  File "/Users/ksdyb/Documents/src/mcp/installer.py", line 3454, in main
    instance_id = create_ec2_instance(
        vpc_info, ec2_role_arn, knowledge_base_role_arn,
        opensearch_info, s3_bucket_name, cloudfront_info["domain"],
        agentcore_memory_role_arn, knowledge_base_id
    )
  File "/Users/ksdyb/Documents/src/mcp/installer.py", line 3014, in create_ec2_instance
    logger.debug(f"Launching EC2 instance: t3.medium in subnet {vpc_info['private_subnets'][0]}")
                                                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range

